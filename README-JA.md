# Dagger - Stable Diffusion向けキャプションエディタ

![image](https://github.com/kznrluk/dagger/assets/29700428/9bfaae0a-382b-4e9c-bfff-12c17ec4d878)

DaggerはStable Diffusionでよく利用されるカンマ区切りキャプションファイルの作成を強力にサポートするアプリケーションです。Webブラウザで利用出来ます。

[ためしてみる](https://dagger.anyfrog.net)

シンプルかつ強力に利用出来るように設計しており、LoRA学習やFineTuning前のデータセットの整理をより効率的に行うことができます。

## 使い方
Daggerは画像ファイルと、画像ファイルと同名のキャプションファイルを1ペアとして扱います。

![image](https://github.com/kznrluk/dagger/assets/29700428/98f60636-7e92-4cfa-b856-1d64a0feae0e)


### 0. 事前準備
DaggerはWD14-Taggerの出力ファイルと互換性があります。必要に応じて事前にタグ付けを行うことが出来ます。

https://github.com/toriato/stable-diffusion-webui-wd14-tagger

### 1. 画像の取り込み

ドラッグアンドドロップでファイルを追加するか、左上のフォルダアイコンから取り込みたいファイルを選択してください。Daggerは選択されたファイルの中から画像ファイルと同名のテキストファイル `.txt, .caption` を検索して1ペアとして扱います。別々での入力は出来ません。

### 2. タグの編集

Daggerには、編集を便利にするいくつかの機能があります。

#### 2-1. 基本機能

画像を選択すると、その画像の詳細情報とタグが右ペインに表示されます。ここからタグを追加したり削除したりすることが出来ます。

画像選択時、CTRLモードやSHIFTモードで画像を複数選択することが出来ます。複数選択時、右側には選択された画像すべてが持つ共通したタグが表示されます。

CTRL+Aで現在フィルタリングされているすべての画像を選択することが出来ます。

#### 2-2. タグフィルター
画像の取り込み後、すべてのタグが画面下部のFILTER BY TAGSに表示されます。これを選択することで、画像を絞り込むことが出来ます。タグの右に表示される数字は、どれだけの画像がそのタグを持っているかを表示します。

![image](https://github.com/kznrluk/dagger/assets/29700428/a59ab230-f3f7-4e8e-9423-2e7db87af1ba)

通常モードでクリックすると、そのタグを**持つ**画像のみが表示されます。複数選択時は選択されたタグすべてを持つ画像が表示されます。

CTRLモードでクリックすると、そのタグを**持たない**画像のみが表示されます。複数選択時は選択されたタグすべてを持たない画像が表示されます。CTRLモード中にタグの削除ボタンをクリックすると、そのタグがすべての画像から削除されます。

![image](https://github.com/kznrluk/dagger/assets/29700428/90508290-c71b-4cc4-a600-55844c0bc956)

#### 2-3. トリミング

画像のトリミングを行うことが出来ます。Saveを押すと、その画像がトリミングされた状態で上書き保存されます。Save as Newを押すと、その画像のコピーが保存されます。

![image](https://github.com/kznrluk/dagger/assets/29700428/b1ba3604-ca03-473c-95c7-76ca423163ca)


### 3. Zipで保存

編集が終わったら左上の保存アイコンから編集後の画像とキャプションファイルを保存します。
このとき、画像を選択した状態で保存アイコンをクリックすると、選択された画像のみが保存されます。特定のタグフィルターを施した状態で `Ctrl+A` を押すことで、そのフィルターの対象となっている画像のみを出力することが出来ます。様々なバリエーションで学習を試したいときに便利な機能です。


## コントリビューション
機能の要望や不具合の報告にはGitHubのIssueを利用してください。日本語圏の方は日本語でOKです。

また、プルリクエストも歓迎しています。ただし、Daggerはシンプルさを重要視しています。機能追加PRはマージしない可能性もありますので注意してください。事前にIssueを発行するとスムーズです。

## ライセンス

MIT

